<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Glitch Slider</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
  <link rel="stylesheet" href="https://unpkg.com/flickity@2/dist/flickity.min.css">
  <link rel="stylesheet" href="https://unpkg.com/flickity-fullscreen@1/fullscreen.css">
  <style type="text/css">
    .bg {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      width: 108vw; height: 108vh;
      background-size: cover; background-position: center;
      filter: grayscale(100%) invert(100%); /* blur(0.3rem) */
    }
    .carousel {
      position: absolute; top: 0; left: 0; bottom: 0; right: 0; margin: auto; max-width: 1024px; max-height: 640px;
    }
    .carousel.is-fullscreen {
      max-width: none; max-height: 100vh;
    }
    .carousel-cell {
      height: 640px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .carousel.is-fullscreen .carousel-cell {
      height: 100%;
    }
    .carousel-cell-image {
      display: block;
      max-height: 100%;
    }
    .carousel.is-fullscreen .carousel-cell-image {
      max-width: 100%;
    }
    .carousel-cell {
      margin-right: 20px;
      overflow: hidden;
    }

    .carousel-cell img {
      filter: grayscale(100%);
      display: block;
      opacity: 0.75;
    }
    .carousel-cell.is-selected img {
      filter: none;
      opacity: 1;
    }
    .flickity-enabled.is-fullscreen {
      padding-bottom: 0;
      background: hsla(0, 0%, 0%, 0.3);
    }
    /*@media screen and ( min-width: 768px ) {
      .carousel-cell img {
        height: 400px;
      }
    }*/

  </style>
</head>
<body>
  <div class="bg"></div>
  <div class="carousel">
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/c6d8fc247ee0669f045e7e3c64c18f19/845d88d9fa2077d1-9c/s1280x1920/3f785329ef70c6eb0b96dd9d2858095e0a28c036.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/f989cde0136ea30959a31dd499108834/845d88d9fa2077d1-2c/s1280x1920/de4cbf4c41cc5c729023bd79d5b66a8eadbdee40.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/9efe08fd0d4207fcbba54271cf5839a2/845d88d9fa2077d1-cb/s1280x1920/cb39e5cb2ad438f46b8d4f02d215352a51b1dafd.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/8a5d811e1071ff51b829afa1fb950421/845d88d9fa2077d1-c1/s1280x1920/3bacbc11aac890dbf31b9ec3345aebabdf049655.pnj" /></div>    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/249733b1740511e91df393f22bbe9ca3/845d88d9fa2077d1-e5/s1280x1920/5a1f2881d9f00edfc18bf7e5e7059467868f3745.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/924699aba3d697c2d551dd49155f32a9/845d88d9fa2077d1-e7/s1280x1920/8bb9cd87f03d94313a42b4b4443fd4e8cda8dcae.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/718ac10f66f5645f7cb02ab1cfdb9d39/845d88d9fa2077d1-87/s1280x1920/6ddb0d82139b5363bbc033120b8612eb0c43de51.pnj" /></div>

    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/f4130df7ed365cc851b4a7184b61cb32/9c5544892970c07e-91/s1280x1920/8b58308d5d1cd8acd292ee11edc054f38e8109d7.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/f54a61b2cfa4fef178b43497c4818b13/9c5544892970c07e-97/s1280x1920/6016dbbc7efc75edb276782abeb7f63424e0814b.jpg" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/45cb2f0ef88cc04bb8204bfb2d032212/9c5544892970c07e-7f/s1280x1920/f123543dec5dc3dec4c98d88d272fd8e8c4d3c43.jpg" /></div>

    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/66824674fec9da5c82eb37f49dca8003/72380137b70e4b5e-f3/s1280x1920/2bde25d835638decd5254395c118ce53f1c90da8.jpg" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/51a8552b42e51c3f4cd44f4ea64efaea/72380137b70e4b5e-25/s1280x1920/7065a7a51f8d30a8f3bfcb1684ceb500107dcb47.jpg" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/a4fedc6d3782aec883f6633a00201be1/72380137b70e4b5e-af/s1280x1920/d1f7e76b07d6322a891f898a17e413a0243491cb.jpg" /></div>

    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/28be0c5f1076b040d01f0ed9342d2eae/5d756ee2104948ac-5f/s1280x1920/1796ed07707b172cacb538975a554b444c54fa00.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/d514c49c105738b2d5c640b68a64d2d8/5d756ee2104948ac-5e/s1280x1920/d91246f659a33d3c466c61ba1e97ed359142492a.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/aa3edeb73a07509d18d71c3232004627/5d756ee2104948ac-10/s1280x1920/1adfc8543c18b66503d985393181837a269b75bf.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/4b78a3115fd87f5fbb49a296090e9733/5d756ee2104948ac-a2/s1280x1920/4d46b1f7938f4246e946d09d25c4d06dd3fe7e01.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/2470dfc69cc319906248abb2fe79a1c4/5d756ee2104948ac-1d/s1280x1920/96447d2b7737f5000f30ff94349ebeb7d36f4dd5.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/2b4f7039d68c71fa5e315d21d286655f/5d756ee2104948ac-e9/s1280x1920/36b7c692dc46f72bdb17276c7bc6906e08cfd3be.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/a86151c2ce63ddaf51cb1b9cc4510edb/5d756ee2104948ac-9a/s1280x1920/7b630db60e1aa57f7da925ef5015b63bcf2c71a9.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/7beeb023071151f994ea2aa6db1a817c/5d756ee2104948ac-34/s1280x1920/1bad56e449bbb2e2324718a0d4d45df885286be8.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/24cea16ebfb3b5692e025df6c859bc11/5d756ee2104948ac-51/s1280x1920/dc1341ba8be4afaec4895390d24fb5763e9e3d84.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/94393e448473f50edc59a6ebfbed69b1/5d756ee2104948ac-1c/s1280x1920/9b2a6746e89b03fd450985c9adb447985204d24e.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/749801c70daa36d1a94b38218b3aa0e1/5d756ee2104948ac-d5/s1280x1920/08d9b125e6292c398e16fc86c3d352d6daa1779a.pnj" /></div>
    <div class="carousel-cell"><img class="carousel-cell-image" data-flickity-lazyload="https://64.media.tumblr.com/85f0a0d8a663eea129f32946108cba0d/5d756ee2104948ac-82/s1280x1920/9652cd74f42e4094d10c98c0f10cafebf3a604a5.pnj" /></div>
  </div>
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
  <script src="https://unpkg.com/flickity-fullscreen@1/fullscreen.js"></script>
  <script type="text/javascript">
    function getRandomInt(min, max) {
      min = Math.ceil(min); max = Math.floor(max);
      return Math.floor(Math.random() * (max - min) + min); // The maximum is exclusive and the minimum is inclusive
    }
    var carousel = document.querySelector('.carousel');
    var flkty = new Flickity(carousel, {
      fade: true,
      // selectedAttraction: 0.01,
      // friction: 0.5,
      // imagesLoaded: true,
      // draggable: false,
      autoPlay: 3000,
      pauseAutoPlayOnHover: true,
      fullscreen: true,
      lazyLoad: 3,
      wrapAround: true,
      cellAlign: 'center',
      pageDots: false,
      arrowShape: { 
        x0: 100,
        x1: 10, y1: 25,
        x2: 85, y2: 50,
        x3: 0
      }
    });

    var imgs = carousel.querySelectorAll('.carousel-cell img');
    // get transform property
    var docStyle = document.documentElement.style;
    var transformProp = typeof docStyle.transform == 'string' ? 'transform' : 'WebkitTransform';

    flkty.on( 'scroll', function() {
      var selected = carousel.querySelectorAll('.carousel-cell.is-selected img');
      var bg = document.querySelectorAll('.bg');
      bg[0].style.backgroundImage = "url('"+selected[0].getAttribute("src")+"')";
      flkty.slides.forEach( function( slide, i ) {
        // console.log(i)
        var img = imgs[i];
        // var x = ( slide.target + flkty.x ) * -1/3;
        // var x = ( slide.target + flkty.x ) * -1/i%3;
        // var x = ( slide.target + flkty.x ) * -1/i%3 * Math.random();
        // var x = ( slide.target + flkty.x ) * -1/Math.sin(i%3) * Math.random();
        var x = ( slide.target + flkty.x ) * -1/Math.sin(Math.PI*i%3) * Math.random();
        img.style[ transformProp ] = 'translateX(' + x  + 'px)';
      });
    });

  </script>


</body></html>